<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualizing Micro-Dispersal • ramp.micro</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing Micro-Dispersal">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ramp.micro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-intro" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Intro</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-intro">
<li><a class="dropdown-item" href="../articles/point_sets.html">Point Sets</a></li>
    <li><a class="dropdown-item" href="../articles/kernels.html">Kernels</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Building a Model</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation</a></li>
    <li><a class="dropdown-item" href="../articles/visualization.html">Visualization</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-modules" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Modules</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-modules">
<li><a class="dropdown-item" href="../articles/BQ.html">Adult Mosquito - BQ Model</a></li>
    <li><a class="dropdown-item" href="../articles/BQS.html">Adult Mosquito - BQS Model</a></li>
    <li><a class="dropdown-item" href="../articles/L.html">Basic Competition - L</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/dispersal.html">Mosquito Dispersal</a></li>
    <li><a class="dropdown-item" href="../articles/trap.html">Trap Algorithm</a></li>
    <li><a class="dropdown-item" href="../articles/community.html">Communitites</a></li>
    <li><a class="dropdown-item" href="../articles/adult.html">Modularity - Adult Mosquito Models</a></li>
    <li><a class="dropdown-item" href="../articles/aquatic.html">Modularity - Aquatic Mosquito Models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dd-harp/motrap.micro/"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualizing Micro-Dispersal</h1>
            
      

      <div class="d-none name"><code>visualizing_dispersal.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridisLite/" class="external-link">viridisLite</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dd-harp.github.io/ramp.micro/">ramp.micro</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In behavioral state micro-simulation, mosquito movement is defined by
a <em>search</em> for a resource, and all resources are located at
points in space,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">(x,y).</annotation></semantics></math>
Micro-dispersal is defined herein as dispersal among point sets
representing the locations of resources.</p>
<p>Micro-dispersal models in this software implementation follow a
common notation:</p>
<ul>
<li><p>A search originates in one point set,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>v</mi></msub><annotation encoding="application/x-tex">P_v</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>v</mi><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|v|</annotation></semantics></math>
locations; and the destination is another,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>w</mi></msub><annotation encoding="application/x-tex">P_w</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">|w|</annotation></semantics></math>
locations.</p></li>
<li><p>A dispersal model is instantiated as a matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>w</mi><mo>←</mo><mi>v</mi></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">M_{w \leftarrow v},</annotation></semantics></math>
where the element
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>∈</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">M_{i,j} \in M</annotation></semantics></math>
is the fraction of mosquitoes moving from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>,</mo><msub><mi>y</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msub><mi>P</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">(x_j, y_j) \in P_v</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∈</mo><msub><mi>P</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">(x_i, y_i) \in P_w</annotation></semantics></math>.</p></li>
<li>
<p>If we had a vector,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>v</mi></msub><annotation encoding="application/x-tex">m_v</annotation></semantics></math>,
of mosquito abundances at the origin of a search, and if we want to
compute a vector,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>w</mi></msub><annotation encoding="application/x-tex">m_w</annotation></semantics></math>,
describing the number arriving at a destination, then we write
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>w</mi></msub><mo>=</mo><mi>M</mi><mo>⋅</mo><msub><mi>m</mi><mi>v</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">m_w = M \cdot m_v,</annotation></semantics></math>
where</p>
<ul>
<li><p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">dim</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>×</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>v</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mbox{dim}(M) = |w| \times |v|,</annotation></semantics></math></p></li>
<li><p>and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>m</mi><mi>v</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>v</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">|m_v| = |v|,</annotation></semantics></math></p></li>
<li><p>so
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>m</mi><mi>w</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>w</mi><mo stretchy="true" form="postfix">|</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">|m_w| = |w|.</annotation></semantics></math></p></li>
</ul>
</li>
</ul>
<p>By convention, we constrain model so that,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>M</mi><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">\sum_i M_{i,j}=1.</annotation></semantics></math></p>
<p>If we want to model failed dispersal, then we will often want to
handle the case where the origin and destination are the same point
set.</p>
<p>In the following, we discuss the challenge of visualizing
micro-dispersal matrices using functions in <code>motrap.micro</code>
where either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>v</mi></msub><mo>≠</mo><msub><mi>P</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">P_v \neq P_w</annotation></semantics></math>
or where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>v</mi></msub><mo>=</mo><msub><mi>P</mi><mi>w</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">P_v = P_w.</annotation></semantics></math></p>
</div>
<div class="section level2">
<h2 id="dispersal-from-p_v-neq-p_w">Dispersal from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>v</mi></msub><mo>≠</mo><msub><mi>P</mi><mi>w</mi></msub></mrow><annotation encoding="application/x-tex">P_v \neq P_w</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#dispersal-from-p_v-neq-p_w"></a>
</h2>
<p>To illustrate, we generate two point sets:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPv</span> <span class="op">=</span> <span class="fl">37</span> </span>
<span><span class="va">nPw</span> <span class="op">=</span> <span class="fl">73</span> </span>
<span><span class="va">dd</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">Pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPv</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">Pw</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPw</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span></code></pre></div>
<p>Now, we can define a dispersal matrix from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>v</mi></msub><annotation encoding="application/x-tex">P_v</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>w</mi></msub><annotation encoding="application/x-tex">P_w</annotation></semantics></math>,
and <em>vice versa</em>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M_wv</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">M_vw</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pw</span>, <span class="va">Pv</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The generic function <code>plot_matrix_xy</code> was developed to
plot dispersal from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>v</mi></msub><annotation encoding="application/x-tex">P_v</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>w</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">P_w.</annotation></semantics></math></p>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="movement">Movement<a class="anchor" aria-label="anchor" href="#movement"></a>
</h2>
<p>Because of the arrangement of points, some points in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>w</mi></msub><annotation encoding="application/x-tex">P_w</annotation></semantics></math>
get more mosquitoes. If an equal number of mosquitoes left every point
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>v</mi></msub><annotation encoding="application/x-tex">P_v</annotation></semantics></math>,
the number arriving at each point in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>w</mi></msub><annotation encoding="application/x-tex">P_w</annotation></semantics></math>
can be found by summing the rows of the dispersal matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Mosquito Density at Destination"</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">j</span>,<span class="va">i</span><span class="op">)</span><span class="op">]</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<p>The matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>
has
<code>nPv</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>29</mn><mo>×</mo></mrow><annotation encoding="application/x-tex">=29 \times</annotation></semantics></math><code>nPw</code><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>43</mn></mrow><annotation encoding="application/x-tex">=43</annotation></semantics></math>
elements, for a total of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>,</mo><mn>161</mn></mrow><annotation encoding="application/x-tex">1,161</annotation></semantics></math>.
This is a reasonably small number of points to consider, but what if we
increased the number of points in each set by a factor of 10 or 100? The
size of the objects can grow quite large quite quickly.</p>
<p>We assume that mosquitoes are more likely to move to nearby sites.
The fraction going to each site is highly uneven. The model computes a
probability of moving between each pair of points, but <em>most</em> of
the elements fractions are very small.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span>, <span class="fl">40</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span>, <span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">50</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
<p>In the following, we draw an arrow from the points in the starting
set
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>v</mi></msub><annotation encoding="application/x-tex">P_v</annotation></semantics></math>,
salmon) to the points in the destination set
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>w</mi></msub><annotation encoding="application/x-tex">P_w</annotation></semantics></math>,
lightblue). On the left, all the edges were plotted, but on the right,
edges were plotted only if the destination got more than 1% of the
dispersing mosquitoes. We vary the size of the destination point to be
the density of mosquitoes arriving:</p>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>In the top, we plot all the dispersal fractions for all the points in
order, and we added a dark blue dot at the point where we stopped
plotting.</p>
<p>Another way to set a cutoff is to compute the empirical cdf (the
cumulati e sum of the top graph) and plot 90% of the total mass (the
dark red dot in the bottom).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">Mo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span><span class="op">[</span><span class="va">ot</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Mo</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"PMF"</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">ix1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Mo</span><span class="op">&gt;</span><span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ix1</span>, <span class="va">Mo</span><span class="op">[</span><span class="va">ix1</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ecdf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">Mo</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ecdf</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"eCMF"</span><span class="op">)</span></span>
<span><span class="va">ix2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ecdf</span> <span class="op">&gt;</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ix2</span>, <span class="va">ecdf</span><span class="op">[</span><span class="va">ix2</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="self">Self<a class="anchor" aria-label="anchor" href="#self"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mvv</span> <span class="op">=</span> <span class="va">M_vw</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">M_wv</span></span>
<span><span class="va">Mww</span> <span class="op">=</span> <span class="va">M_wv</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">M_vw</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="plot-size">Plot Size<a class="anchor" aria-label="anchor" href="#plot-size"></a>
</h2>
<p>We can now ask a practical question – how many edges would we plot if
the system was much larger:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nEdges</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nS</span>, <span class="va">nD</span>, <span class="va">frac</span><span class="op">=</span><span class="fl">0.01</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dd</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nS</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span>  <span class="va">D</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nD</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span>  <span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">D</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">Mo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">[</span><span class="va">ot</span><span class="op">]</span></span>
<span>  <span class="va">ix1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Mo</span><span class="op">&gt;</span><span class="va">frac</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ix1</span>, <span class="va">nS</span><span class="op">*</span><span class="va">nD</span>, <span class="va">ix1</span><span class="op">/</span><span class="va">nS</span><span class="op">/</span><span class="va">nD</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>If we generated 20 models that were statistically indistinguishable
from the one above, we can compute the average number of edges plotted,
and the average fraction of edges showing.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu">nEdges</span><span class="op">(</span><span class="fl">27</span>, <span class="fl">43</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">out</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>nEdges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## nEdges </span></span>
<span><span class="co">## 385.05</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fracEdges <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## fracEdges </span></span>
<span><span class="co">## 0.3316537</span></span></code></pre>
<p>If we start with ten times as many source and destination point, we
end up plotting about 20 times as many points:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu">nEdges</span><span class="op">(</span><span class="fl">270</span>, <span class="fl">430</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">out</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>nEdges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  nEdges </span></span>
<span><span class="co">## 7709.45</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fracEdges <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  fracEdges </span></span>
<span><span class="co">## 0.06640353</span></span></code></pre>
<p>The plot is much busier to look at, but it renders in a reasonable
amount of time:</p>
<p><strong>This code was not run because it creates and stores an object
that is bigger than we wanted to store on github. Try running this code
on your computer and see what happens?</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPv</span> <span class="op">=</span> <span class="fl">270</span> </span>
<span><span class="va">nPw</span> <span class="op">=</span> <span class="fl">430</span> </span>
<span><span class="va">dd</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">Pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPv</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">Pw</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPw</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_matrix_xy.html">plot_matrix_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="va">M</span>, min_edge_frac <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span> </span></code></pre></div>
<p>If we plotted 50 times as many of each, now something suprising
happens:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu">nEdges</span><span class="op">(</span><span class="fl">270</span><span class="op">*</span><span class="fl">5</span>, <span class="fl">430</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">out</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>nEdges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## nEdges </span></span>
<span><span class="co">## 2434.3</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fracEdges <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    fracEdges </span></span>
<span><span class="co">## 0.0008386908</span></span></code></pre>
<p>We end up plotting fewer edges. What’s happening?</p>
<p><strong>This code was not run because it creates and stores an object
that is bigger than we wanted to store on github. Try running this code
on your computer and see what happens?</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPv</span> <span class="op">=</span> <span class="fl">270</span><span class="op">*</span><span class="fl">5</span> </span>
<span><span class="va">nPw</span> <span class="op">=</span> <span class="fl">430</span><span class="op">*</span><span class="fl">5</span> </span>
<span><span class="va">dd</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">Pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPv</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">Pw</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPw</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_matrix_xy.html">plot_matrix_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="va">M</span>, min_edge_frac <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </span></code></pre></div>
<p>The visualization is emphasizing the weights of points in the corner,
which have fewer neighbors than points near the center. The result is a
figure that illustrates both the importance of being able to visualize a
model, and the importance of understanding how this approach highlights
real and serious questions about mosquito dispersal – what happens at
the edges of habitats?</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David L. Smith, Héctor M. Sánchez C.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
